import{i as a,g as n,m as i,n as o,o as u}from"./watch-later-DSiUGnA7.js";async function c(){if(a)try{const e=n(),s=i(),r=new Date(Date.now()-864e5).toISOString().split("T")[0];let t=await e.streak.get("main");if(t||(t=o()),t.lastStudyDate===s)return;t.studyDates.includes(s)||t.studyDates.push(s),t.lastStudyDate===r?t.currentStreak++:t.lastStudyDate!==s&&(t.currentStreak=1),t.currentStreak>t.longestStreak&&(t.longestStreak=t.currentStreak),t.lastStudyDate=s,await e.streak.put(t)}catch(e){console.error("Error updating streak:",e)}}async function d(e,s,r=!1){if(!a)return"";try{const t=u();return await n().sessions.put({id:t,videoId:e,videoTitle:s,startTime:new Date().toISOString(),duration:0,notes:"",focusMode:r}),await c(),t}catch(t){return console.error("Error starting session:",t),""}}async function S(e=10){if(!a)return[];try{return await n().sessions.orderBy("startTime").reverse().filter(r=>!!r.endTime).limit(e).toArray()}catch{return[]}}export{S as g,d as s,c as u};
